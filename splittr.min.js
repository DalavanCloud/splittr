//    Part of the Splittr Library
//       (C) 2013 Shane Carr
//   Released under the X11 License
// https://github.com/vote539/splittr

(function(f){f.splittr={};f.splittr.barBreadth=5;f.splittr.init=function(){var a=/^(horizontal|vertical) (static|dynamic) ((?:\d+ ?)+)$/;f.splittr.util.get(document,function(){var c=this.getAttribute("data-splittr");if(!c)return!1;var b=a.exec(c);if(!b)throw Error("Splittr: Invalid options string.  (Read '"+c+"')");var d="vertical"===b[1],e="dynamic"===b[2],k=b[3].split(" "),m=document.createElement("div");d?m.setAttribute("class","splittr-bar-container splittr-bar-container-vertical"):m.setAttribute("class",
"splittr-bar-container splittr-bar-container-horizontal");var l=0,n=[],c=f.splittr.util.children(this,function(a){var c=parseInt(k[a])||0;this.collapsible=null!==this.getAttribute("data-splittr-collapsible");0<a&&(a=f.splittr.util.makeBar(d,e,l),m.appendChild(a),n.push(a),l+=f.splittr.barBreadth);d?(this.style.left=l+"px",this.style.width=c+"px"):(this.style.top=l+"px",this.style.height=c+"px");l+=c},!0);this.appendChild(m);b=c[c.length-1];d?(b.style.width="auto",b.style.right=0):(b.style.height=
"auto",b.style.bottom=0);for(b=n.length-1;0<=b;b--){var h=n[b],g=c[b],p=c[b+1];e&&(f.splittr.util.handleMouseEvents(h,g,p,d),g.collapsible&&h.addCollapse(!0,d,g,p),p.collapsible&&h.addCollapse(!1,d,g,p));g.next=p;p.prev=g;h.next=p;h.prev=g;g.nextBar=h;p.prevBar=h}f.splittr.util.handleWindowResizeEvent(this,c,d)},!1)};f.splittr.resize=function(a,c,b){var d=a.parentNode.getAttribute("data-splittr");if(null===d)throw Error("Splittr: Attempted to resize an uninitialized element.");var d=0===d.indexOf("vertical"),
e=c-(d?a.offsetWidth:a.offsetHeight);if(b){if(!a.prev)throw Error("Splittr: Must have previous panel (anchor next)");d?(a.prev.style.width=a.prev.offsetWidth-e+"px",a.prevBar.style.left=a.prevBar.offsetLeft-e+"px",a.style.left=a.offsetLeft-e+"px",a.style.width=c+"px"):(a.prev.style.height=a.prev.offsetHeight-e+"px",a.prevBar.style.top=a.prevBar.offsetTop-e+"px",a.style.top=a.offsetTop-e+"px",a.style.height=c+"px")}else{if(!a.next)throw Error("Splittr: Must have next panel (anchor prev)");d?(a.next.style.width=
a.next.offsetWidth-e+"px",a.next.style.left=a.next.offsetLeft+e+"px",a.nextBar.style.left=a.nextBar.offsetLeft+e+"px",a.style.width=c+"px"):(a.next.style.height=a.next.offsetHeight-e+"px",a.next.style.top=a.next.offsetTop+e+"px",a.nextBar.style.top=a.nextBar.offsetTop+e+"px",a.style.height=c+"px")}f.splittr.util.dispatchSplitterMove(a.parentNode,a.prev,a.next);f.splittr.util.dispatchSplitterDone(a.parentNode,a.prev,a.next)};f.splittr.util={};f.splittr.util.copy=function(a){var c=[],b;for(b in a)a.hasOwnProperty(b)&&
c.push(a[b]);return c};f.splittr.util.get=function(a,c,b){a=a.getElementsByTagName("*");b&&(a=f.splittr.util.copy(a));return f.splittr.util._elements(a,c)};f.splittr.util._elements=function(a,c){for(var b=[],d=0,f=0;f<a.length;f++){var k=a[f];1===k.nodeType&&(c&&!1===c.call(k,d++)||b.push(k))}return b};f.splittr.util.children=function(a,c,b){a=a.childNodes;b&&(a=f.splittr.util.copy(a));return f.splittr.util._elements(a,c)};f.splittr.util.makeBar=function(a,c,b){var d=document.createElement("div"),
e="splittr-bar";a?(e+=" splittr-bar-vertical",d.style.width=f.splittr.barBreadth+"px",d.style.left=b+"px"):(e+=" splittr-bar-horizontal",d.style.height=f.splittr.barBreadth+"px",d.style.top=b+"px");c&&(e+=" splittr-bar-dynamic");d.setAttribute("class",e);d.addCollapse=function(a,c,b,e){var h=document.createElement("div");h.setAttribute("class","splittr-handle-container");var g=document.createElement("div");g.setAttribute("class",a?"splittr-handle-prev":"splittr-handle-next");g.appendChild(document.createTextNode(a?
c?"\u25c0":"\u25b2":c?"\u25b6":"\u25bc"));g.addEventListener("click",function(g){a?c?(d.style.left=d.offsetLeft-b.offsetWidth+"px",e.style.left=d.offsetLeft+d.offsetWidth+"px",e.style.width=e.offsetWidth+b.offsetWidth+"px",b.style.width=0):(d.style.top=d.offsetTop-b.offsetHeight+"px",e.style.top=d.offsetTop+d.offsetHeight+"px",e.style.height=e.offsetHeight+b.offsetHeight+"px",b.style.height=0):c?(d.style.left=d.offsetLeft+e.offsetWidth+"px",e.style.left=e.offsetLeft+e.offsetWidth+"px",b.style.width=
b.offsetWidth+e.offsetWidth+"px",e.style.width=0):(d.style.top=d.offsetTop+e.offsetHeight+"px",e.style.top=e.offsetTop+e.offsetHeight+"px",b.style.height=b.offsetHeight+e.offsetHeight+"px",e.style.height=0);f.splittr.util.dispatchSplitterMove(d.parentNode.parentNode,b,e)},!1);h.appendChild(g);d.appendChild(h)};return d};f.splittr.util.getTotalOffsetTop=function(a){var c=0;do c+=a.offsetTop;while(a=a.offsetParent);return c};f.splittr.util.getTotalOffsetLeft=function(a){var c=0;do c+=a.offsetLeft;while(a=
a.offsetParent);return c};f.splittr.util.handleMouseEvents=function(a,c,b,d){var e=null,k,m,l,n,h;a.addEventListener("mousedown",function(f){f.preventDefault();e=d?f.clientX:f.clientY;k=d?a.offsetLeft:a.offsetTop;n=d?c.offsetWidth:c.offsetHeight;h=d?b.offsetWidth:b.offsetHeight;m=0-n;l=h},!1);f.addEventListener("mousemove",function(g){null!==e&&(g.preventDefault(),g=(d?g.clientX:g.clientY)-e,g<m&&(g=m),g>l&&(g=l),d?(a.style.left=k+g+"px",c.style.width=n+g+"px",b.style.left=k+g+f.splittr.barBreadth+
"px",b.style.width=h-g+"px"):(a.style.top=k+g+"px",c.style.height=n+g+"px",b.style.top=k+g+f.splittr.barBreadth+"px",b.style.height=h-g+"px"),f.splittr.util.dispatchSplitterMove(b.parentNode,c,b))},!1);f.addEventListener("mouseup",function(a){null!==e&&(e=null,f.splittr.util.dispatchSplitterDone(b.parentNode,c,b))},!1)};f.splittr.util.handleWindowResizeEvent=function(a,c,b){f.addEventListener("resize",function(a){})};f.splittr.util.dispatchSplitterMove=function(a,c,b){var d=document.createEvent("Event");
d.initEvent("splitterMove",!0,!0);d.prev=c;d.next=b;a.dispatchEvent(d)};f.splittr.util.dispatchSplitterDone=function(a,c,b){var d=document.createEvent("Event");d.initEvent("splitterDone",!0,!0);d.prev=c;d.next=b;a.dispatchEvent(d)}})(window);