//    Part of the Splittr Library
//       (C) 2013 Shane Carr
//   Released under the X11 License
// https://github.com/vote539/splittr

(function(e){e.splittr={};e.splittr.barBreadth=5;e.splittr.init=function(){var a=/^(horizontal|vertical) (static|dynamic) ((?:\d+ ?)+)$/;e.splittr.util.get(document,function(){var c=this.getAttribute("data-splittr");if(!c)return!1;var b=a.exec(c);if(!b)throw Error("Splittr: Invalid options string.  (Read '"+c+"')");var d="vertical"===b[1],f="dynamic"===b[2],m=b[3].split(" "),p=document.createElement("div");d?p.setAttribute("class","splittr-bar-container splittr-bar-container-vertical"):p.setAttribute("class",
"splittr-bar-container splittr-bar-container-horizontal");var n=0,h=[],c=e.splittr.util.children(this,function(a){var b=parseInt(m[a])||0;this.collapsible=null!==this.getAttribute("data-splittr-collapsible");0<a&&(a=e.splittr.util.makeBar(d,f,n),p.appendChild(a),h.push(a),n+=e.splittr.barBreadth);d?(this.style.left=n+"px",this.style.width=b+"px"):(this.style.top=n+"px",this.style.height=b+"px");n+=b},!0);this.appendChild(p);b=c[c.length-1];d?(b.style.width="auto",b.style.right=0):(b.style.height=
"auto",b.style.bottom=0);for(b=h.length-1;0<=b;b--){var l=h[b],k=c[b],g=c[b+1];f&&(e.splittr.util.handleMouseEvents(l,k,g,d,b===h.length-1),k.collapsible&&l.addCollapse(!0,d,k,g,b===h.length-1),g.collapsible&&l.addCollapse(!1,d,k,g,b===h.length-1));k.next=g;g.prev=k;l.next=g;l.prev=k;k.nextBar=l;g.prevBar=l}e.splittr.util.handleWindowResizeEvent(this,c,d)},!1)};e.splittr.resize=function(a,c,b){var d=a.parentNode.getAttribute("data-splittr");if(null===d)throw Error("Splittr: Attempted to resize an uninitialized element.");
var d=0===d.indexOf("vertical"),f=c-(d?a.offsetWidth:a.offsetHeight);if(b){if(!a.prev)throw Error("Splittr: Must have previous panel (anchor next)");d?(a.prev.style.width=a.prev.offsetWidth-f+"px",a.prevBar.style.left=a.prevBar.offsetLeft-f+"px",a.style.left=a.offsetLeft-f+"px",a.style.width=c+"px"):(a.prev.style.height=a.prev.offsetHeight-f+"px",a.prevBar.style.top=a.prevBar.offsetTop-f+"px",a.style.top=a.offsetTop-f+"px",a.style.height=c+"px")}else{if(!a.next)throw Error("Splittr: Must have next panel (anchor prev)");
b=!a.next.next;d?(b||(a.next.style.width=a.next.offsetWidth-f+"px"),a.next.style.left=a.next.offsetLeft+f+"px",a.nextBar.style.left=a.nextBar.offsetLeft+f+"px",a.style.width=c+"px"):(b||(a.next.style.height=a.next.offsetHeight-f+"px"),a.next.style.top=a.next.offsetTop+f+"px",a.nextBar.style.top=a.nextBar.offsetTop+f+"px",a.style.height=c+"px")}e.splittr.util.dispatchSplitterMove(a.parentNode,a.prev,a.next);e.splittr.util.dispatchSplitterDone(a.parentNode,a.prev,a.next)};e.splittr.util={};e.splittr.util.copy=
function(a){var c=[],b;for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c};e.splittr.util.get=function(a,c,b){a=a.getElementsByTagName("*");b&&(a=e.splittr.util.copy(a));return e.splittr.util._elements(a,c)};e.splittr.util._elements=function(a,c){for(var b=[],d=0,e=0;e<a.length;e++){var m=a[e];1===m.nodeType&&(c&&!1===c.call(m,d++)||b.push(m))}return b};e.splittr.util.children=function(a,c,b){a=a.childNodes;b&&(a=e.splittr.util.copy(a));return e.splittr.util._elements(a,c)};e.splittr.util.makeBar=
function(a,c,b){var d=document.createElement("div"),f="splittr-bar";a?(f+=" splittr-bar-vertical",d.style.width=e.splittr.barBreadth+"px",d.style.left=b+"px"):(f+=" splittr-bar-horizontal",d.style.height=e.splittr.barBreadth+"px",d.style.top=b+"px");c&&(f+=" splittr-bar-dynamic");d.setAttribute("class",f);d.addCollapse=function(a,b,c,h,f){var k=document.createElement("div");k.setAttribute("class","splittr-handle-container");var g=document.createElement("div");g.setAttribute("class",a?"splittr-handle-prev":
"splittr-handle-next");g.appendChild(document.createTextNode(a?b?"\u25c0":"\u25b2":b?"\u25b6":"\u25bc"));g.addEventListener("click",function(g){a?b?(d.style.left=d.offsetLeft-c.offsetWidth+"px",h.style.left=d.offsetLeft+d.offsetWidth+"px",f||(h.style.width=h.offsetWidth+c.offsetWidth+"px"),c.style.width=0):(d.style.top=d.offsetTop-c.offsetHeight+"px",h.style.top=d.offsetTop+d.offsetHeight+"px",f||(h.style.height=h.offsetHeight+c.offsetHeight+"px"),c.style.height=0):b?(d.style.left=d.offsetLeft+h.offsetWidth+
"px",h.style.left=h.offsetLeft+h.offsetWidth+"px",c.style.width=c.offsetWidth+h.offsetWidth+"px",f||(h.style.width=0)):(d.style.top=d.offsetTop+h.offsetHeight+"px",h.style.top=h.offsetTop+h.offsetHeight+"px",c.style.height=c.offsetHeight+h.offsetHeight+"px",f||(h.style.height=0));e.splittr.util.dispatchSplitterMove(d.parentNode.parentNode,c,h)},!1);k.appendChild(g);d.appendChild(k)};return d};e.splittr.util.getTotalOffsetTop=function(a){var c=0;do c+=a.offsetTop;while(a=a.offsetParent);return c};
e.splittr.util.getTotalOffsetLeft=function(a){var c=0;do c+=a.offsetLeft;while(a=a.offsetParent);return c};e.splittr.util.handleMouseEvents=function(a,c,b,d,f){var m=null,p,n,h,l,k;a.addEventListener("mousedown",function(e){e.preventDefault();m=d?e.clientX:e.clientY;p=d?a.offsetLeft:a.offsetTop;l=d?c.offsetWidth:c.offsetHeight;k=d?b.offsetWidth:b.offsetHeight;n=0-l;h=k},!1);e.addEventListener("mousemove",function(g){null!==m&&(g.preventDefault(),g=(d?g.clientX:g.clientY)-m,g<n&&(g=n),g>h&&(g=h),d?
(a.style.left=p+g+"px",c.style.width=l+g+"px",b.style.left=p+g+e.splittr.barBreadth+"px",f||(b.style.width=k-g+"px")):(a.style.top=p+g+"px",c.style.height=l+g+"px",b.style.top=p+g+e.splittr.barBreadth+"px",f||(b.style.height=k-g+"px")),e.splittr.util.dispatchSplitterMove(b.parentNode,c,b))},!1);e.addEventListener("mouseup",function(a){null!==m&&(m=null,e.splittr.util.dispatchSplitterDone(b.parentNode,c,b))},!1)};e.splittr.util.handleWindowResizeEvent=function(a,c,b){e.addEventListener("resize",function(a){})};
e.splittr.util.dispatchSplitterMove=function(a,c,b){var d=document.createEvent("Event");d.initEvent("splitterMove",!0,!0);d.prev=c;d.next=b;a.dispatchEvent(d)};e.splittr.util.dispatchSplitterDone=function(a,c,b){var d=document.createEvent("Event");d.initEvent("splitterDone",!0,!0);d.prev=c;d.next=b;a.dispatchEvent(d)}})(window);